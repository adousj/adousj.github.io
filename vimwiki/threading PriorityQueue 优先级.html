<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>threading PriorityQueue 优先级</title>

  <link rel="stylesheet" href="bootstrap3/css/bootstrap.min.css">
  <link rel="stylesheet" href="bootstrap3/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="Font-Awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/style.css">

</head>
<body>

<div class="navbar navbar-inverse bg-midnight-blue navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Adou Wiki</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Vimwiki</a>
    </div>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">首页</a></li>
        <li><a href="计划.html">计划</a></li>
        <li><a href="学习计划.html">学习计划</a></li>
        <li><a href="小小工具.html">小小工具</a></li>
        <li><a href="娱乐.html">娱乐</a></li>
        <li><a href="tips.html">tips</a></li>
        <li><a href="about me.html">关于我</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-8 col-md-offset-2 bg-clouds col-lg-8 col-lg-offset-2 col-xs-12 content-block" id="main-content">

      
<h1 id="toc_1">threading PriorityQueue 优先级</h1>

<p>
各个进程读取(in)优先队列是有序的
out 是无序的
(一定要设定保护进程，否则程序无法停止。)
</p>

<pre>
import Queue
import threading
import sys
import time
import random


class Worker(threading.Thread):
    ''''''
    def __init__(self,queue):
        threading.Thread.__init__(self)
        self.__queue = queue
        self.setDaemon(True)

    def run(self):
        while True:
            try :
                item = self.__queue.get()
                print item , 'in'
                time.sleep(random.randint(100,1000)/1000.0)
                print item , 'out'
                self.__queue.task_done()
            except Queue.Empty:
                break


queue = Queue.PriorityQueue()

queue.put((20,'second'))
queue.put((10,'first'))
queue.put((30,'third'))

for i in xrange(3):
    Worker(queue).start()

queue.put((50,'fifth'))
queue.put((80,'eighth'))
queue.put((70,'seventh'))
queue.put((60,'sixth'))

queue.join()
sys.exit(0)
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
(10, 'first') in
(20, 'second') in
(30, 'third') in
(30, 'third') out
(50, 'fifth') in
(20, 'second') out
(60, 'sixth') in
(50, 'fifth') out
(70, 'seventh') in
(10, 'first') out
(80, 'eighth') in
(70, 'seventh') out
(80, 'eighth') out
(60, 'sixth') out
</pre>

      
      <br>
      <div class="pull-right">
        <!-- JiaThis Button BEGIN -->
        <div class="jiathis_style_24x24">
          <a class="jiathis_button_qzone"></a>
          <a class="jiathis_button_tsina"></a>
          <a class="jiathis_button_weixin"></a>
          <a class="jiathis_button_renren"></a>
          <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
        </div>
        <script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
        <!-- JiaThis Button END -->
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8 col-md-offset-2 bg-clouds col-lg-8 col-lg-offset-2 col-xs-12 content-block">

      <!-- Duoshuo Comment BEGIN -->
      <div class="ds-thread"></div>
      <script type="text/javascript">
      var duoshuoQuery = {short_name:"adousj"};
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = 'http://static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0] 
          || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
        </script>
      <!-- Duoshuo Comment END -->

    </div>
  </div>
</div>

<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="bootstrap3/js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/blog.js"></script>

</body>
</html>
